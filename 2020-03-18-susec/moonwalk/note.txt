Didn't solve but I think I got pretty close to reversing it
